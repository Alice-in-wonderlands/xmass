<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Long Distance Christmas Postcard</title>
    <!-- Load Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Homemade Apple Font (Handwriting style) -->
    <link href="https://fonts.googleapis.com/css2?family=Homemade+Apple&display=swap" rel="stylesheet"> 
    
    <!-- Configure Tailwind to use Inter font and define custom colors --><script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Màu sắc đã được tinh chỉnh cho tông Đỏ Rượu và Xanh Rừng Sâu
                        'christmas-red': '#8B0000', // Deep Wine Red
                        'christmas-green': '#003D1A', // Deep Forest Green
                        'gold': '#D97706', // Gold/Orange
                        'snow-white': '#F9FAFB',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        unfold: {
                            '0%': { transform: 'scaleY(0)' },
                            '100%': { transform: 'scaleY(1)' },
                        }
                    },
                    animation: {
                        fadeIn: 'fadeIn 1.5s ease-out',
                        unfold: 'unfold 1.2s ease-out', // Tăng thời gian animation lên 1.2s
                    }
                }
            }
        }
    </script>
    <style>
        /* Import Inter font from Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');

        /* New class for the handwriting font */
        .homemade-font { 
            font-family: 'Homemade Apple', cursive; 
            font-size: 1.25rem; /* Kích thước lớn hơn để dễ đọc */
            line-height: 2.5rem; /* Độ giãn dòng phù hợp với chữ viết tay */
        }
        
        /* Ensure the unfolding effect happens from the top of the letter */
        .animate-unfold {
            transform-origin: top;
        }

        /* Custom scrollbar styling for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--tw-colors-christmas-red);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-track {
            background: var(--tw-colors-christmas-green);
        }

        /* ------------------------------------------- */
        /* Custom CSS for the Decorative Bow and Frame */
        /* ------------------------------------------- */

        /* The main bow container (Red) */
        .christmas-bow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 20; /* Above the content */
            pointer-events: none; /* Ensure clicks pass through */
        }

        /* The Ribbon Knot (Gold center) */
        .bow-knot {
            width: 30px;
            height: 30px;
            background-color: var(--tw-colors-gold);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.5);
        }

        /* The Bow Loops (Red) */
        .bow-loop {
            width: 80px;
            height: 80px;
            background-color: var(--tw-colors-christmas-red);
            border: 4px solid var(--tw-colors-gold);
            border-radius: 50%;
            position: absolute;
            opacity: 0.95;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .loop-left {
            transform: translate(calc(-50% - 45px), calc(-50% - 15px)) rotate(-25deg);
        }

        .loop-right {
            transform: translate(calc(-50% + 15px), calc(-50% - 15px)) rotate(25deg);
        }

        /* The Tassel/Streamer (Green) */
        .bow-streamer {
            width: 15px;
            height: 100px;
            background-color: var(--tw-colors-christmas-green);
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: top center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .streamer-left {
            transform: translate(calc(-50% - 10px), calc(-50% + 10px)) rotate(-10deg);
            clip-path: polygon(0% 0%, 100% 0%, 100% 90%, 50% 100%, 0% 90%); /* V-cut */
        }

        .streamer-right {
            transform: translate(calc(-50% + 10px), calc(-50% + 10px)) rotate(10deg);
            clip-path: polygon(0% 0%, 100% 0%, 100% 90%, 50% 100%, 0% 90%); /* V-cut */
        }
    </style>
</head>

<body class="bg-christmas-green min-h-screen flex items-center justify-center p-4 font-sans">

    <!-- CANVAS CHO HIỆU ỨNG TUYẾT RƠI (phải đặt trước) --><canvas id="snow-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></canvas>

    <!-- Main Application Container --><div id="app-container" class="w-full max-w-4xl min-h-[70vh] flex flex-col items-center justify-center relative z-10">

        <!-- Stage 1: The Postcard Cover (Màn hình bìa bưu thiếp) --><div id="cover-stage" class="absolute inset-0 bg-christmas-red rounded-xl shadow-2xl flex flex-col items-center justify-center p-8 transition-all duration-500 cursor-pointer hover:scale-[1.01] hover:shadow-gold"
            onclick="openPostcard()">
            <div class="text-snow-white text-5xl md:text-7xl font-black tracking-widest animate-bounce">
                MERRY XMAS
            </div>
            <p class="text-snow-white text-xl mt-4 border-2 border-snow-white p-2 rounded-lg italic">
                Bưu Thiếp Từ Xa
            </p>
            <p class="text-gold text-sm mt-8">Nhấn vào bất cứ đâu để mở</p>
        </div>

        <!-- Stage 1.5: Password Overlay (Lớp phủ nhập mật khẩu) --><div id="password-stage" class="absolute inset-0 bg-christmas-green/95 backdrop-blur-sm rounded-xl shadow-2xl hidden flex-col items-center justify-center p-8 animate-fadeIn">
            <div class="bg-snow-white p-8 rounded-xl shadow-2xl w-full max-w-sm text-center">
                <h2 class="text-3xl font-bold text-christmas-red mb-4">Nhập Mật Khẩu Cá Nhân</h2>
                <p class="text-sm text-christmas-green mb-6">Bạn phải biết tên người nhận để mở!</p>
                <input type="password" id="password-input" placeholder="Tên người nhận (ví dụ: gemma)"
                       class="w-full p-3 border-2 border-gold rounded-lg focus:outline-none focus:ring-2 focus:ring-christmas-red text-center text-lg mb-4"
                       onkeyup="if(event.key === 'Enter') checkPassword()">
                
                <button onclick="checkPassword()"
                        class="w-full px-8 py-3 text-xl font-bold bg-gold text-white rounded-full shadow-lg transition-all duration-300 hover:scale-[1.02] active:translate-y-1">
                    Mở Thư
                </button>
                <p id="error-message" class="text-christmas-red mt-3 hidden">Mật khẩu không đúng. Vui lòng thử lại!</p>
            </div>
        </div>

        <!-- Stage 2: The Card (Nội dung thiệp Giáng Sinh) --><div id="card-stage" class="absolute inset-0 bg-snow-white rounded-xl shadow-2xl p-6 md:p-12 hidden flex-col overflow-y-auto animate-fadeIn"
            style="border: 8px solid; border-image: linear-gradient(45deg, var(--tw-colors-christmas-red), var(--tw-colors-gold), var(--tw-colors-christmas-green)) 1;">

            <!-- The Red Bow in the middle of the card (Chiếc nơ đỏ ở giữa) --><div class="christmas-bow z-20">
                <div class="bow-streamer streamer-left"></div>
                <div class="bow-streamer streamer-right"></div>
                <div class="bow-loop loop-left"></div>
                <div class="bow-loop loop-right"></div>
                <div class="bow-knot"></div>
            </div>
            
            <!-- Letter Content will be dynamically inserted here (Nội dung thư cá nhân hóa) --><div id="personalized-letter" class="text-center w-full max-w-lg mx-auto p-4 md:p-8 bg-snow-white/95 rounded-xl z-10">
                <!-- Content inserted by JavaScript --></div>
        </div>
    </div>

    <script>
        const coverStage = document.getElementById('cover-stage');
        const passwordStage = document.getElementById('password-stage');
        const cardStage = document.getElementById('card-stage');
        const passwordInput = document.getElementById('password-input');
        const errorMessage = document.getElementById('error-message');
        const personalizedLetter = document.getElementById('personalized-letter');
        const bow = document.querySelector('.christmas-bow');

        // Define the content and image for each friend (Định nghĩa nội dung và hình ảnh cho từng người bạn)
        const letterContents = {
            caitlin: {
                image: 'WILL1.jpg', // Tên file ảnh cho Caitlin
                title: "Dành tặng Caitlin thân yêu",
                message: "Caitlin à, Giáng Sinh này, dù xa cách, tớ vẫn luôn nhớ đến những kỷ niệm vui vẻ của chúng ta. Chúc cậu một mùa lễ hội ấm áp, an lành và hạnh phúc. Hy vọng chúng ta sẽ sớm gặp lại nhau!",
                signOff: "Yêu cậu nhiều, [Tên của bạn]"
            },
            sophie: {
                image: 'WILL4.jpg', // Tên file ảnh cho Sophie
                title: "Một bức thư ngọt ngào cho Sophie",
                message: "Sophie ơi, Giáng Sinh đến rồi! Tớ gửi lời chúc tốt đẹp nhất đến cậu. Hãy tận hưởng những khoảnh khắc tuyệt vời bên gia đình và bạn bè nhé. Cậu là một người bạn tuyệt vời và tớ rất nhớ cậu! Chúc Mừng Giáng Sinh!",
                signOff: "Thân mến, [Tên của bạn]"
            },
            dan: {
                image: 'WILL3.jpg', // Tên file ảnh cho Dan
                title: "Gửi Dan, người bạn tuyệt vời!",
                message: "Này Dan, Giáng Sinh là dịp để nhớ về những người bạn như cậu. Hy vọng cậu đang có một khoảng thời gian nghỉ ngơi tuyệt vời. Hãy giữ ấm và có một kỳ nghỉ lễ thật nhiều niềm vui nhé. Nhớ giữ liên lạc nha!",
                signOff: "Người bạn, [Tên của bạn]"
            },
            gemma: {
                image: 'WILL2.jpg', // Tên file ảnh cho Gemma
                title: "Gemma, mùa lễ hội rực rỡ nhé!",
                message: "Gemma thân mến, tớ muốn gửi đến cậu những lời chúc Giáng Sinh ấm áp nhất. Dù không thể ở bên, tớ vẫn luôn nghĩ về cậu. Chúc cậu một năm mới tràn đầy may mắn và thành công. Merry Christmas!",
                signOff: "Với tất cả tình yêu thương, [Tên của bạn]"
            }
        };

        // Function to handle the initial postcard opening
        function openPostcard() {
            // Animate cover slide-out/fade
            coverStage.classList.remove('animate-bounce');
            coverStage.classList.add('opacity-0', 'scale-110');

            setTimeout(() => {
                coverStage.classList.add('hidden');
                // Show the password stage
                passwordStage.classList.remove('hidden');
                passwordStage.classList.add('flex');
                passwordInput.focus();
            }, 500); // Wait for the transition to finish
        }

        // Function to check the password and display the card
        function checkPassword() {
            // Get input and convert to lowercase for case-insensitive check
            const input = passwordInput.value.toLowerCase().trim();
            errorMessage.classList.add('hidden'); // Reset error message

            // Check if the input is one of the valid recipients
            if (letterContents.hasOwnProperty(input)) {
                // Correct password: hide password stage and show card stage
                passwordStage.classList.add('hidden');
                cardStage.classList.remove('hidden');
                cardStage.classList.add('flex');
                
                // Load the personalized content
                loadLetter(input);
            } else {
                // Incorrect password
                errorMessage.classList.remove('hidden');
                passwordInput.value = ''; // Clear input
                passwordInput.focus();
            }
        }

        // Function to insert the correct letter content
        function loadLetter(recipient) {
            const content = letterContents[recipient];
            
            // Generate the HTML for the letter, bao gồm thẻ <img>
            // Thêm class animate-unfold vào div ngoài để tạo hiệu ứng mở thư
            const letterHtml = `
                <div class="animate-unfold">
                    <img src="${content.image}" alt="Ảnh cá nhân của ${recipient}" 
                         class="w-40 h-40 object-cover rounded-full mx-auto mb-6 shadow-md border-4 border-gold">
                    <h2 class="text-3xl md:text-4xl font-extrabold text-christmas-red mb-6 border-b-2 pb-2 border-gold">
                        ${content.title}
                    </h2>
                    <!-- Áp dụng font chữ viết tay ở đây -->
                    <div class="text-christmas-green text-lg leading-relaxed mb-6 mt-4 text-left homemade-font">
                        <p class="mb-4">
                            ${content.message}
                        </p>
                        <p class="mt-8 text-right text-xl font-bold text-gold">
                            ${content.signOff}
                        </p>
                    </div>
                </div>
            `;
            
            // Insert the HTML into the card
            personalizedLetter.innerHTML = letterHtml;

            // Remove pointer events from the bow so the user can scroll the letter on mobile/small screens
            bow.style.pointerEvents = 'none'; 
        }

        // Initialize focus on the password field if it's visible (for testing/development)
        if (passwordStage.classList.contains('flex')) {
             passwordInput.focus();
        }


        // ----------------------------------------------------
        // --- LOGIC CHO HIỆU ỨNG TUYẾT RƠI (SNOW EFFECT) ---
        // ----------------------------------------------------
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let snowflakes = [];
        const maxSnowflakes = 150;

        // Thiết lập kích thước canvas theo kích thước cửa sổ
        function setupCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', setupCanvas);
        setupCanvas(); 

        // Hàm tạo một bông tuyết mới
        function createSnowflake() {
            return {
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                radius: Math.random() * 2 + 1, // Kích thước 1px đến 3px
                density: Math.random() * 1 + 0.5, // Mật độ ảnh hưởng tốc độ
                speed: Math.random() * 1 + 0.5,
                wind: (Math.random() - 0.5) * 0.5, // Chuyển động ngang nhẹ (gió)
            };
        }

        // Khởi tạo mảng bông tuyết
        for (let i = 0; i < maxSnowflakes; i++) {
            snowflakes.push(createSnowflake());
        }

        // Hàm vẽ và cập nhật vị trí bông tuyết
        function drawSnowflakes() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Màu tuyết trắng hơi trong suốt (để tuyết không quá chói)
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)'; 

            for (let i = 0; i < maxSnowflakes; i++) {
                let s = snowflakes[i];
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.radius, 0, Math.PI * 2);
                ctx.fill();

                // Cập nhật vị trí
                s.y += s.speed * s.density;
                s.x += s.wind;

                // Nếu tuyết rơi ra khỏi màn hình, đặt lại nó ở trên cùng
                if (s.y > canvas.height) {
                    s.y = 0;
                    s.x = Math.random() * canvas.width;
                }

                // Xử lý bao bọc ngang (nếu tuyết bay ra mép trái/phải, nó xuất hiện ở mép đối diện)
                if (s.x > canvas.width) {
                    s.x = 0;
                } else if (s.x < 0) {
                    s.x = canvas.width;
                }
            }
            requestAnimationFrame(drawSnowflakes);
        }

        // Bắt đầu hiệu ứng tuyết rơi
        drawSnowflakes();
    </script>
</body>
</html>
