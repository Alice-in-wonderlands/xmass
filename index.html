<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Christmas Card</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Homemade+Apple&family=Mountains+of+Christmas:wght@400;700&display=swap" rel="stylesheet"> 
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'christmas-red': '#B22222',
                        'christmas-green': '#03241b',
                        'gold': '#D4AF37',
                    },
                    fontFamily: {
                        'handwriting': ['Homemade Apple', 'cursive'],
                        'festive': ['Mountains of Christmas', 'serif'],
                    }
                }
            }
        }
    </script>
    <style>
        .light-string {
            position: absolute; top: 0; left: 0; width: 100%; height: 40px;
            display: flex; justify-content: space-around; z-index: 60; pointer-events: none;
        }
        .light {
            width: 12px; height: 12px; border-radius: 50%;
            animation: twinkle 1.5s infinite ease-in-out;
        }
        @keyframes twinkle { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        
        .postcard-container {
            background-color: #FDF5E6;
            background-image: radial-gradient(#dbd2bc 0.5px, transparent 0.5px);
            background-size: 10px 10px;
            border: 15px solid white;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            position: relative; min-height: 500px;
        }
        .postcard-divider {
            position: absolute; left: 50%; top: 10%; bottom: 10%;
            width: 2px; background: linear-gradient(to bottom, transparent, #8B4513, transparent);
            opacity: 0.3;
        }
    </style>
</head>

<body class="bg-christmas-green min-h-screen flex items-center justify-center p-4 overflow-hidden" onclick="initAudio()">
    
    <audio id="christmas-music" loop>
        <source src="song.mp3" type="audio/mpeg">
    </audio>

    <div class="light-string">
        <div class="light bg-red-500"></div>
        <div class="light bg-yellow-400" style="animation-delay: 0.2s"></div>
        <div class="light bg-blue-500" style="animation-delay: 0.4s"></div>
        <div class="light bg-green-500" style="animation-delay: 0.6s"></div>
        <div class="light bg-red-500" style="animation-delay: 0.8s"></div>
    </div>

    <canvas id="snow-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-0"></canvas>

    <div id="app-container" class="w-full max-w-5xl relative z-10">
        <div id="merry-christmas-cover" class="bg-christmas-red rounded-3xl shadow-2xl flex flex-col items-center justify-center p-12 cursor-pointer border-8 border-gold/30" onclick="openCover()">
            <div class="text-white text-6xl md:text-8xl font-festive font-bold animate-pulse text-center">
                Merry Christmas
            </div>
            <div class="mt-6 px-6 py-2 bg-gold text-christmas-green font-bold rounded-full transform -rotate-2">
                FROM ALICE WITH LOVE
            </div>
            <p class="text-white/70 mt-12 animate-bounce italic text-sm">Ch·∫°m v√†o m√†n h√¨nh ƒë·ªÉ b·∫Øt ƒë·∫ßu b·∫£n nh·∫°c... ‚ùÑÔ∏è</p>
        </div>

        <div id="password-stage" class="hidden flex-col items-center justify-center">
            <div class="bg-white/95 p-10 rounded-2xl shadow-2xl w-full max-w-sm border-t-8 border-christmas-red">
                <h2 class="text-3xl font-festive font-bold text-christmas-red text-center mb-6">X√°c nh·∫≠n danh t√≠nh</h2>
                <input type="text" id="password-input" placeholder="T√™n c·ªßa b·∫°n l√†..." 
                       class="w-full p-4 border-2 border-gold/30 rounded-xl focus:outline-none focus:border-christmas-red text-center text-lg mb-6">
                <button onclick="checkPassword()" class="w-full py-4 bg-christmas-red text-white font-bold rounded-xl hover:bg-red-700">M·ªû QU√Ä üéÅ</button>
                <p id="error-message" class="text-red-600 mt-4 text-center hidden">B·∫°n kh√¥ng c√≥ trong danh s√°ch!</p>
            </div>
        </div>

        <div id="sealed-envelope-stage" class="hidden flex-col items-center justify-center">
            <div class="relative w-full max-w-md aspect-[4/3] bg-red-800 rounded-lg shadow-2xl border-4 border-gold/20 flex items-center justify-center cursor-pointer overflow-hidden" onclick="openSealedEnvelope()">
                <div id="envelope-flap" class="absolute top-0 left-0 w-full h-1/2 bg-red-900 z-20 origin-top transition-transform duration-700" style="clip-path: polygon(0 0, 100% 0, 50% 100%);"></div>
                <div id="envelope-seal" class="absolute top-1/2 left-1/2 z-30 transition-all duration-700 -translate-x-1/2 -translate-y-1/2">
                    <div class="w-16 h-16 bg-gold rounded-full flex items-center justify-center shadow-lg border-2 border-yellow-600">üéÑ</div>
                </div>
                <div class="text-center z-10 mt-32 text-gold font-handwriting text-2xl" id="envelope-recipient-name"></div>
            </div>
        </div>

        <div id="card-stage" class="hidden flex-col">
            <div class="postcard-container rounded-sm flex flex-col md:flex-row p-6 md:p-10 text-stone-800 font-handwriting">
                <div class="postcard-divider hidden md:block"></div>
                <div class="w-full md:w-1/2 md:pr-10">
                    <img id="recipient-photo" src="" class="w-32 h-32 rounded-lg object-cover border-4 border-white shadow-md mb-4 -rotate-3">
                    <div id="main-message" class="text-lg leading-loose whitespace-pre-line"></div>
                </div>
                <div class="w-full md:w-1/2 md:pl-10 mt-10 md:mt-0 flex flex-col items-end">
                    <div class="w-full space-y-6 mt-12">
                        <div class="border-bottom border-stone-400 border-b pb-2">To: <span id="addr-name" class="font-bold"></span></div>
                        <div class="border-bottom border-stone-400 border-b pb-2">North Pole, Snow Lane</div>
                    </div>
                    <button onclick="location.reload()" class="mt-20 text-xs text-stone-500 underline">G·ª≠i th∆∞ kh√°c</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const audio = document.getElementById('christmas-music');
        let isInit = false;

        // H√†m k√≠ch ho·∫°t nh·∫°c t·ª´ gi√¢y th·ª© 3
        function initAudio() {
            if (!isInit) {
                audio.currentTime = 3; // Nh·∫£y ƒë·∫øn gi√¢y th·ª© 3
                audio.play().catch(() => {});
                isInit = true;
            }
        }

        const recipients = {
            caitlin: { name: 'Caitlin', img: 'WILL1.jpg', msg: "Caitlin th√¢n m·∫øn,\nCh√∫c b·∫°n m·ªôt Gi√°ng sinh ·∫•m √°p v√† l·∫•p l√°nh nh∆∞ nh·ªØng v√¨ sao!" },
            sophie: { name: 'Sophie', img: 'WILL4.jpg', msg: "Sophie ∆°i,\nHy v·ªçng t·∫•m thi·ªáp n√†y s·∫Ω mang n·ª• c∆∞·ªùi ƒë·∫øn cho b·∫°n h√¥m nay!" },
            dan: { name: 'Dan', img: 'WILL3.jpg', msg: "Ch√†o Dan,\nCh√∫c m·ªôt m√πa l·ªÖ h·ªôi th·∫≠t chill v√† tr√†n ƒë·∫ßy ƒë·ªì ƒÉn ngon nh√©!" },
            gemma: { name: 'Gemma', img: 'WILL2.jpg', msg: "Gemma th√¢n m·∫øn,\nC·∫£m ∆°n v√¨ ƒë√£ lu√¥n l√† m·ªôt ng∆∞·ªùi b·∫°n tuy·ªát v·ªùi. Merry Christmas!" },
            anya: { name: 'Anya', img: 'WILL1.jpg', msg: "Anya √†,\nCh√∫c c·∫≠u m·ªôt m√πa ƒë√¥ng kh√¥ng l·∫°nh v√† th·∫≠t nhi·ªÅu qu√† d∆∞·ªõi c√¢y th√¥ng nh√©!" },
            libby: { name: 'Libby', img: 'WILL2.jpg', msg: "G·ª≠i Libby,\nMong m·ªçi ƒëi·ªÅu ∆∞·ªõc c·ªßa c·∫≠u trong ƒë√™m Noel ƒë·ªÅu th√†nh hi·ªán th·ª±c!" },
            lizzie: { name: 'Lizzie', img: 'WILL3.jpg', msg: "Lizzie th√¢n m·∫øn,\nCh√∫c c·∫≠u m·ªôt Gi√°ng sinh an l√†nh v√† m·ªôt nƒÉm m·ªõi r·ª±c r·ª°!" },
            ciara: { name: 'Ciara', img: 'WILL4.jpg', msg: "Ciara ∆°i,\nCh√∫c c·∫≠u lu√¥n h·∫°nh ph√∫c v√† xinh ƒë·∫πp nh∆∞ nh·ªØng ƒë√≥a hoa m√πa ƒë√¥ng!" },
            harriet: { name: 'Harriet', img: 'WILL1.jpg', msg: "Harriet th√¢n m·∫øn,\nCh√∫c b·∫°n m·ªôt m√πa l·ªÖ h·ªôi tr√†n ng·∫≠p ni·ªÅm vui b√™n gia ƒë√¨nh!" },
            hannah: { name: 'Hannah', img: 'WILL2.jpg', msg: "G·ª≠i Hannah,\nC·∫£m ∆°n c·∫≠u v√¨ t·∫•t c·∫£. Ch√∫c c·∫≠u m·ªôt ƒë√™m Noel th·∫≠t k·ª≥ di·ªáu!" },
            zach: { name: 'Zach', img: 'WILL3.jpg', msg: "Yo Zach,\nGi√°ng sinh vui v·∫ª nh√© bro! Ch√∫c √¥ng g·∫∑t h√°i ƒë∆∞·ª£c nhi·ªÅu th√†nh c√¥ng!" },
            jordy: { name: 'Jordy', img: 'WILL4.jpg', msg: "Jordy ∆°i,\nCh√∫c c·∫≠u m·ªôt nƒÉm m·ªõi b√πng n·ªï v√† m·ªôt m√πa Gi√°ng sinh ·∫•m √°p!" }
        };

        let currentKey = '';

        function openCover() {
            initAudio();
            document.getElementById('merry-christmas-cover').classList.add('hidden');
            document.getElementById('password-stage').classList.remove('hidden');
            document.getElementById('password-stage').classList.add('flex');
        }

        function checkPassword() {
            const val = document.getElementById('password-input').value.toLowerCase().trim();
            if (recipients[val]) {
                currentKey = val;
                document.getElementById('password-stage').classList.replace('flex', 'hidden');
                document.getElementById('envelope-recipient-name').innerText = "To: " + recipients[val].name;
                document.getElementById('sealed-envelope-stage').classList.remove('hidden');
                document.getElementById('sealed-envelope-stage').classList.add('flex');
            } else {
                document.getElementById('error-message').classList.remove('hidden');
            }
        }

        function openSealedEnvelope() {
            document.getElementById('envelope-flap').style.transform = 'rotateX(180deg)';
            document.getElementById('envelope-seal').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('sealed-envelope-stage').classList.replace('flex', 'hidden');
                const data = recipients[currentKey];
                document.getElementById('card-stage').classList.remove('hidden');
                document.getElementById('recipient-photo').src = data.img;
                document.getElementById('main-message').innerText = data.msg;
                document.getElementById('addr-name').innerText = data.name;
            }, 800);
        }

        // Hi·ªáu ·ª©ng tuy·∫øt r∆°i
        const canvas = document.getElementById('snow-canvas');
        const ctx = canvas.getContext('2d');
        let flakes = [];
        function initSnow() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            flakes = Array.from({length: 100}, () => ({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height,
                r: Math.random() * 3 + 1,
                d: Math.random() * 1
            }));
        }
        function drawSnow() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "white";
            ctx.beginPath();
            flakes.forEach(f => {
                ctx.moveTo(f.x, f.y);
                ctx.arc(f.x, f.y, f.r, 0, Math.PI*2);
                f.y += Math.cos(f.d) + 1 + f.r/2;
                f.x += Math.sin(f.d) * 2;
                if(f.y > canvas.height) f.y = -10;
            });
            ctx.fill();
            requestAnimationFrame(drawSnow);
        }
        window.onload = () => { initSnow(); drawSnow(); };
    </script>
</body>
</html>
